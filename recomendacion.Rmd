---
title: "recomendacion"
author: "Miguel Figueira"
date: "5 de mayo de 2016"
output: html_document
---


# Sistemas de Recomendación

### Cargar bibliotecas y setwd
```{r,warning=FALSE}
library("arules")
library("dplyr")
library("arulesViz")
setwd("C:/Users/Alex/Documents/R/DM_T4/recomendacion-modelos")
```


### Función para asignar valores
```{r}
asignar <- function(valor){
  #función para asignar valores
  
  valor <- gsub(pattern = "item", x = valor, replacement = "")
  valor <- gsub(pattern = "}",x=valor,replacement = "")
  valor <- gsub(pattern = "\\{",x=valor,replacement = "")
  
  a <- as.integer(unlist(strsplit(valor,split = ",")))
  for(j in 1:length(a)){
    if(j == 1){
      h <- paste(valores[a[1]])
    }else{
      h <- paste(h,valores[a[j]],sep=",")
    }
  }
  return(h)
}
```

### read.csv

```{r}
ejemplo <- read.csv("data/ejemplo.csv")
periodico <- read.csv("data/periodico.csv")
```



### delete useless feature
```{r}


ejemplo$X <- NULL
periodico$X <- NULL
```



### arreglo con todos los temas
```{r}
contenido <- c("deporte","politica","variedades","internacional","nacionales",
               "sucesos","comunidad","negocios","opinion")
```


### Preparando arreglos para combinarlos con pastie
```{r}
contenido <- rep(contenido,each=9) 

articulo <- paste0("articulo",rep(x=1:9,times=9),sep="")
```


###  arreglo necesario para poder asignar correctamente contenido/articuloN
```{r}
valores <- paste(contenido,articulo,sep = "/")
```

### Asigna al dataframe la columna items con el formato pedido
```{r}
periodico$items <- sapply(periodico$articles, asignar)
```

### Lo transformo para poder calcular el tiempo de estadia de cada visita
```{r}
periodico$entry <- as.POSIXct(periodico$entry, origin = "1970-01-01")
periodico$exit <- as.POSIXct(periodico$exit, origin = "1970-01-01")
```


###  Creo nueva columna llamada estadia que tiene el tiempo en segundos de estadia
```{r}
periodico <- mutate(periodico, estadia = exit - entry)
estadia <- periodico$estadia
```


```{r}
###  10 visitas con menor tiempo de estadia
estadia <-estadia[order(estadia)]
estadia[1:10]
```

# 10 visitas con mayor tiempo de estadia

```{r}
estadia <-estadia[order(estadia,decreasing = T)]
estadia[1:10]
```





